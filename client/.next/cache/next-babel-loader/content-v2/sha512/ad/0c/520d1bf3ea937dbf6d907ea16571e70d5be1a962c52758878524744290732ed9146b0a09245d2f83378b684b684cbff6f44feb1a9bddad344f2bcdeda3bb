{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/home/mohammad/projects/dorreh/market multi/client/src/layout/CI/Layout/components/chat/PrivateChat/PrivateChat.tsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { ReactComponent as ArrowDown } from \"assets/images/icons/Arrows/Big/Down.svg\";\nimport { ReactComponent as ArrowUp } from \"assets/images/icons/Arrows/Big/up.svg\";\nimport { ReactComponent as CloseSvg } from \"assets/images/icons/UI/Close.svg\";\nimport { ReactComponent as ImageIcon } from \"assets/images/icons/Content/Image.svg\";\nimport { ReactComponent as AttachIcon } from \"assets/images/icons/Content/Attachment.svg\";\nimport GolButton from \"components/GolButton\";\nimport GolTextField from \"components/GolTextField\";\nimport { useSession } from \"next-auth/client\";\nimport React, { useEffect, useRef, useState } from \"react\";\nimport { useIntl } from \"react-intl\";\nimport { usePrivateChatStyle } from \"./usePrivateChatStyle\";\nimport MessangerMessages from \"../Messanger.message\";\n\nconst PrivateChat = ({\n  selectedContact,\n  setPrivate,\n  connection,\n  connectionStarted,\n  messages,\n  setMessages\n}) => {\n  const styles = usePrivateChatStyle();\n  const {\n    formatMessage\n  } = useIntl();\n  const {\n    0: open,\n    1: setOpen\n  } = useState(true);\n  const {\n    0: message,\n    1: setMessage\n  } = useState(\"\");\n  const {\n    0: unreadedMessages,\n    1: setUnreadedMessages\n  } = useState(0);\n  const [session] = useSession();\n  const msgRef = useRef(null);\n\n  const sendMessage = async e => {\n    e.preventDefault();\n    const chatMessage = {\n      toUser: session.user.name === \"test1 test2\" ? \"2ffbd6df-c56b-4c46-b15c-5e41e5516950\" : \"350f6455-c93a-4267-b3a4-943a1a459afc\",\n      message\n    };\n\n    if (connection.connectionStarted) {\n      try {\n        await connection.send(\"SendMessage\", chatMessage);\n        setMessages(prev => [...prev, _objectSpread(_objectSpread({}, chatMessage), {}, {\n          dateTime: new Date()\n        })]);\n        setMessage(\"\");\n      } catch (e) {\n        console.log(e);\n      }\n    } else {\n      alert(\"No connection to server yet.\");\n    }\n  };\n\n  useEffect(() => {\n    var _messages;\n\n    const scroll = msgRef.current.scrollHeight - msgRef.current.clientHeight;\n\n    if (messages && (_messages = messages[messages.length - 1]) !== null && _messages !== void 0 && _messages.fromUser) {\n      console.log(\"scrollHeight: \", msgRef.current.scrollHeight);\n      console.log(\"scrollTop: \", msgRef.current.scrollTop);\n      console.log(msgRef.current.scrollHeight - msgRef.current.scrollTop);\n\n      if (msgRef.current.scrollTop && msgRef.current.scrollHeight - msgRef.current.scrollTop > 505) {\n        setUnreadedMessages(prev => prev += 1);\n      } else {\n        msgRef.current.scrollTo(0, scroll);\n      }\n    } else {\n      msgRef.current.scrollTo(0, scroll);\n    }\n  }, [messages]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: styles.root,\n    style: open ? {\n      bottom: 0\n    } : {\n      bottom: -519\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.header,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: `${selectedContact === null || selectedContact === void 0 ? void 0 : selectedContact.firstName} ${selectedContact === null || selectedContact === void 0 ? void 0 : selectedContact.lastName}`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.spaceBetween,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.toggle,\n          onClick: () => setOpen(!open),\n          children: open ? /*#__PURE__*/_jsxDEV(ArrowDown, {\n            className: styles.sendSvg\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 89,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(ArrowUp, {\n            className: styles.sendSvg\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 91,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            cursor: \"pointer\"\n          },\n          children: /*#__PURE__*/_jsxDEV(CloseSvg, {\n            onClick: () => setPrivate(false)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.body,\n      ref: msgRef,\n      children: selectedContact ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.messages,\n        children: messages.map(item => /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: !(item !== null && item !== void 0 && item.fromUser) ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: styles.message,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: styles.spaceBetweenMe,\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: styles.avatar\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 108,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: styles.date,\n                children: new Date(item === null || item === void 0 ? void 0 : item.dateTime).toLocaleTimeString()\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 109,\n                columnNumber: 23\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 107,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: styles.bottomMe,\n              children: item === null || item === void 0 ? void 0 : item.message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 113,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 106,\n            columnNumber: 19\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: styles.message,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: styles.spaceBetween,\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: styles.avatar\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 118,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: styles.date,\n                children: new Date(item === null || item === void 0 ? void 0 : item.dateTime).toLocaleTimeString()\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 119,\n                columnNumber: 23\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 117,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: styles.bottom,\n              children: item === null || item === void 0 ? void 0 : item.message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 123,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 19\n          }, this)\n        }, void 0, false))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: formatMessage(MessangerMessages.noMessage)\n      }, void 0, false)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.sendMessage,\n      children: [unreadedMessages ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.unReadedMessages,\n        onClick: () => {\n          const scroll = msgRef.current.scrollHeight - msgRef.current.clientHeight;\n          msgRef.current.scrollTo(0, scroll);\n          setUnreadedMessages(0);\n        },\n        children: unreadedMessages\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 11\n      }, this) : null, /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: sendMessage,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.sendMessageInput,\n          children: /*#__PURE__*/_jsxDEV(GolTextField, {\n            value: message,\n            onChange: e => setMessage(e.target.value),\n            className: styles.searchInput,\n            placeholder: formatMessage(MessangerMessages.writeMessage)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 150,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.sendMessageTools,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: styles.attachIcon,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: /*#__PURE__*/_jsxDEV(AttachIcon, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 160,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 159,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: /*#__PURE__*/_jsxDEV(ImageIcon, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 163,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 162,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 158,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(GolButton, {\n            type: \"submit\",\n            color: \"primary\",\n            variant: \"contained\",\n            children: formatMessage(MessangerMessages.send)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 166,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 80,\n    columnNumber: 5\n  }, this);\n};\n\nexport default PrivateChat;","map":{"version":3,"sources":["/home/mohammad/projects/dorreh/market multi/client/src/layout/CI/Layout/components/chat/PrivateChat/PrivateChat.tsx"],"names":["ReactComponent","ArrowDown","ArrowUp","CloseSvg","ImageIcon","AttachIcon","GolButton","GolTextField","useSession","React","useEffect","useRef","useState","useIntl","usePrivateChatStyle","MessangerMessages","PrivateChat","selectedContact","setPrivate","connection","connectionStarted","messages","setMessages","styles","formatMessage","open","setOpen","message","setMessage","unreadedMessages","setUnreadedMessages","session","msgRef","sendMessage","e","preventDefault","chatMessage","toUser","user","name","send","prev","dateTime","Date","console","log","alert","scroll","current","scrollHeight","clientHeight","length","fromUser","scrollTop","scrollTo","root","bottom","header","firstName","lastName","spaceBetween","toggle","sendSvg","cursor","body","map","item","spaceBetweenMe","avatar","date","toLocaleTimeString","bottomMe","noMessage","unReadedMessages","sendMessageInput","target","value","searchInput","writeMessage","sendMessageTools","attachIcon"],"mappings":"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","sourcesContent":["import { ReactComponent as ArrowDown } from \"assets/images/icons/Arrows/Big/Down.svg\";\nimport { ReactComponent as ArrowUp } from \"assets/images/icons/Arrows/Big/up.svg\";\nimport { ReactComponent as CloseSvg } from \"assets/images/icons/UI/Close.svg\";\nimport { ReactComponent as ImageIcon } from \"assets/images/icons/Content/Image.svg\";\nimport { ReactComponent as AttachIcon } from \"assets/images/icons/Content/Attachment.svg\";\nimport GolButton from \"components/GolButton\";\nimport GolTextField from \"components/GolTextField\";\nimport { useSession } from \"next-auth/client\";\nimport React, { useEffect, useRef, useState } from \"react\";\nimport { useIntl } from \"react-intl\";\nimport { usePrivateChatStyle } from \"./usePrivateChatStyle\";\nimport MessangerMessages from \"../Messanger.message\";\n\nconst PrivateChat = ({\n  selectedContact,\n  setPrivate,\n  connection,\n  connectionStarted,\n  messages,\n  setMessages,\n}) => {\n  const styles = usePrivateChatStyle();\n  const { formatMessage } = useIntl();\n  const [open, setOpen] = useState(true);\n  const [message, setMessage] = useState(\"\");\n  const [unreadedMessages, setUnreadedMessages] = useState(0);\n\n  const [session] = useSession();\n  const msgRef = useRef(null);\n\n  const sendMessage = async (e) => {\n    e.preventDefault();\n    const chatMessage = {\n      toUser:\n        session.user.name === \"test1 test2\"\n          ? \"2ffbd6df-c56b-4c46-b15c-5e41e5516950\"\n          : \"350f6455-c93a-4267-b3a4-943a1a459afc\",\n      message,\n    };\n\n    if (connection.connectionStarted) {\n      try {\n        await connection.send(\"SendMessage\", chatMessage);\n\n        setMessages((prev) => [\n          ...prev,\n          { ...chatMessage, dateTime: new Date() },\n        ]);\n\n        setMessage(\"\");\n      } catch (e) {\n        console.log(e);\n      }\n    } else {\n      alert(\"No connection to server yet.\");\n    }\n  };\n\n  useEffect(() => {\n    const scroll = msgRef.current.scrollHeight - msgRef.current.clientHeight;\n    if (messages && messages[messages.length - 1]?.fromUser) {\n      console.log(\"scrollHeight: \", msgRef.current.scrollHeight);\n      console.log(\"scrollTop: \", msgRef.current.scrollTop);\n      console.log(msgRef.current.scrollHeight - msgRef.current.scrollTop);\n      if (\n        msgRef.current.scrollTop &&\n        msgRef.current.scrollHeight - msgRef.current.scrollTop > 505\n      ) {\n        setUnreadedMessages((prev) => (prev += 1));\n      } else {\n        msgRef.current.scrollTo(0, scroll);\n      }\n    } else {\n      msgRef.current.scrollTo(0, scroll);\n    }\n  }, [messages]);\n\n\n  return (\n    <div\n      className={styles.root}\n      style={open ? { bottom: 0 } : { bottom: -519 }}\n    >\n      <div className={styles.header}>\n        <div>{`${selectedContact?.firstName} ${selectedContact?.lastName}`}</div>\n        <div className={styles.spaceBetween}>\n          <div className={styles.toggle} onClick={() => setOpen(!open)}>\n            {open ? (\n              <ArrowDown className={styles.sendSvg} />\n            ) : (\n              <ArrowUp className={styles.sendSvg} />\n            )}\n          </div>\n          <div style={{ cursor: \"pointer\" }}>\n            <CloseSvg onClick={() => setPrivate(false)} />\n          </div>\n        </div>\n      </div>\n\n      <div className={styles.body} ref={msgRef}>\n        {selectedContact ? (\n          <div className={styles.messages}>\n            {messages.map((item) => (\n              <>\n                {!item?.fromUser ? (\n                  <div className={styles.message}>\n                    <div className={styles.spaceBetweenMe}>\n                      <div className={styles.avatar}></div>\n                      <div className={styles.date}>\n                        {new Date(item?.dateTime).toLocaleTimeString()}\n                      </div>\n                    </div>\n                    <div className={styles.bottomMe}>{item?.message}</div>\n                  </div>\n                ) : (\n                  <div className={styles.message}>\n                    <div className={styles.spaceBetween}>\n                      <div className={styles.avatar}></div>\n                      <div className={styles.date}>\n                        {new Date(item?.dateTime).toLocaleTimeString()}\n                      </div>\n                    </div>\n                    <div className={styles.bottom}>{item?.message}</div>\n                  </div>\n                )}\n              </>\n            ))}\n          </div>\n        ) : (\n          <>{formatMessage(MessangerMessages.noMessage)}</>\n        )}\n      </div>\n\n      <div className={styles.sendMessage}>\n        {unreadedMessages ? (\n          <div\n            className={styles.unReadedMessages}\n            onClick={() => {\n              const scroll =\n                msgRef.current.scrollHeight - msgRef.current.clientHeight;\n              msgRef.current.scrollTo(0, scroll);\n              setUnreadedMessages(0);\n            }}\n          >\n            {unreadedMessages}\n          </div>\n        ) : null}\n        <form onSubmit={sendMessage}>\n          <div className={styles.sendMessageInput}>\n            <GolTextField\n              value={message}\n              onChange={(e) => setMessage(e.target.value)}\n              className={styles.searchInput}\n              placeholder={formatMessage(MessangerMessages.writeMessage)}\n            />\n          </div>\n          <div className={styles.sendMessageTools}>\n            <div className={styles.attachIcon}>\n              <div>\n                <AttachIcon />\n              </div>\n              <div>\n                <ImageIcon />\n              </div>\n            </div>\n            <GolButton type=\"submit\" color=\"primary\" variant=\"contained\">\n              {formatMessage(MessangerMessages.send)}\n            </GolButton>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n};\n\nexport default PrivateChat;\n"]},"metadata":{},"sourceType":"module"}